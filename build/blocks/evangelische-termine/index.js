!function(){"use strict";var e,n={284:function(e,n,t){var r=window.ReactJSXRuntime,a=window.wp.blocks;function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function l(e,n){if(e){if("string"==typeof e)return i(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,n):void 0}}function o(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,i,l,o=[],s=!0,u=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=i.call(t)).done)&&(o.push(r.value),o.length!==n);s=!0);}catch(e){u=!0,a=e}finally{try{if(!s&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw a}}return o}}(e,n)||l(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=window.regeneratorRuntime,u=t.n(s),c=window.wp.blockEditor,d=window.wp.components,p=window.wp.element,f=window.wp.apiFetch,v=t.n(f),h=window.wp.i18n,g=function(e){var n=[];e._place_NAME&&n.push(e._place_NAME);var t=[];e._place_STREET_NR&&t.push(e._place_STREET_NR);var r=[e._place_ZIP,e._place_CITY].filter(Boolean).join(" ").trim();if(r&&t.push(r),t.length&&n.push(t.join(", ")),n.length)return n.join(", ")},m=JSON.parse('{"UU":"evangelische-termine-ausgeben/evangelische-termine"}');(0,a.registerBlockType)(m.UU,{icon:{src:(0,r.jsxs)("svg",{id:"Ebene_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[(0,r.jsx)("rect",{x:"60.05",y:"115.69",width:"112.94",height:"280.62",rx:"5.73",ry:"5.73",fill:"evenodd",strokeWidth:"0"}),(0,r.jsx)("rect",{x:"199.53",y:"115.69",width:"112.94",height:"280.62",rx:"5.73",ry:"5.73",fill:"evenodd",strokeWidth:"0"}),(0,r.jsx)("rect",{x:"339.01",y:"115.69",width:"112.94",height:"280.62",rx:"5.73",ry:"5.73",fill:"evenodd",strokeWidth:"0"})]})},__experimentalLabel:function(e,n){var t=n.context,r=e.title;if("list-view"===t&&r)return r},edit:function(e){var n=this,t=e.attributes,a=e.setAttributes,s=(0,c.useBlockProps)(),f=t.id,m=t.limit,b=t.eventType,_=void 0===b?"":b,x=t.people,y=void 0===x?"":x,w=t.placeType,j=void 0===w?"":w,T=t.searchText,S=void 0===T?"":T,C=o((0,p.useState)([]),2),E=C[0],O=C[1],A=o((0,p.useState)(null),2),I=A[0],V=A[1],R=o((0,p.useState)(!1),2),k=R[0],N=R[1],P=(0,h.__)("Alle Veranstaltungstypen","evangelische-termine-ausgeben"),D=(0,h.__)("Alle Zielgruppen","evangelische-termine-ausgeben"),U=(0,h.__)("Alle Orte","evangelische-termine-ausgeben"),B=o((0,p.useState)([{label:P,value:""}]),2),F=B[0],L=B[1],M=o((0,p.useState)([{label:D,value:""}]),2),Z=M[0],H=M[1],W=o((0,p.useState)([{label:U,value:""}]),2),G=W[0],J=W[1],z=(0,p.useMemo)((function(){var e;if(!j)return null;var n=G.find((function(e){return e.value===j&&""!==e.value}));return null!==(e=null==n?void 0:n.label)&&void 0!==e?e:null}),[G,j]);return(0,p.useEffect)((function(){var e,t,r,a,o=!0,s=[{endpoint:"eventtypes",setter:L,label:P},{endpoint:"people",setter:H,label:D},{endpoint:"placetype",setter:J,label:U}];return e=n,t=void 0,r=void 0,a=u().mark((function e(){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled(s.map((function(e){return n=e.endpoint,v()({path:"evangelische-termine-ausgeben/v1/data?endpoint=".concat(n)});var n})));case 2:if(n=e.sent,o){e.next=5;break}return e.abrupt("return");case 5:n.forEach((function(e,n){if("fulfilled"===e.status){var t=s[n];t.setter((a=e.value,[{label:t.label,value:""}].concat(function(e){if(Array.isArray(e))return i(e)}(r=a.map((function(e){return{label:e.name,value:String(e.id)}})))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||l(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())))}else console.error("Error fetching ".concat(s[n].endpoint,":"),e.reason);var r,a}));case 6:case"end":return e.stop()}}),e)})),new(r||(r=Promise))((function(n,i){function l(e){try{s(a.next(e))}catch(e){i(e)}}function o(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,o)}s((a=a.apply(e,t||[])).next())})),function(){o=!1}}),[P,D,U]),(0,p.useEffect)((function(){if(f&&(!j||z)){N(!0);var e=new URLSearchParams;e.append("vid",f),m&&e.append("itemsPerPage",String(m)),_&&e.append("eventtype",_),y&&e.append("people",y),j&&e.append("placetype",j);var n=e.toString();v()({path:"evangelische-termine-ausgeben/v1/data?endpoint=events&".concat(n)}).then((function(e){console.log(e);var n=e.map((function(e){return{id:e.Veranstaltung.ID,title:e.Veranstaltung._event_TITLE,datum:e.Veranstaltung.DATUM,startRFC:e.Veranstaltung.START_RFC,startTime:e.Veranstaltung.START_UHRZEIT?e.Veranstaltung.START_UHRZEIT.replace(".",":"):void 0,placeCategory:e.Veranstaltung._place_KAT,shortDescription:e.Veranstaltung._event_SHORT_DESCRIPTION,longDescription:e.Veranstaltung._event_LONG_DESCRIPTION,location:g(e.Veranstaltung),detailsUrl:e.Veranstaltung.ID?"https://www.evangelische-termine.de/d-".concat(e.Veranstaltung.ID):void 0}}));j&&z&&(n=n.filter((function(e){return e.placeCategory===z})));var t=S.trim().toLowerCase();t&&(n=n.filter((function(e){return[e.title,e.shortDescription,e.longDescription].filter(Boolean).map((function(e){return e.toLowerCase()})).some((function(e){return e.includes(t)}))}))),O(n),V(null),N(!1)})).catch((function(e){console.error("Error fetching events:",e),V((0,h.__)("Fehler beim Abrufen der Veranstaltungen.","evangelische-termine-ausgeben")),N(!1)}))}}),[f,m,_,y,j,z,S]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.InspectorControls,{children:(0,r.jsxs)(d.PanelBody,{title:(0,h.__)("Einstellungen","evangelische-termine-ausgeben"),children:[(0,r.jsx)(d.TextControl,{label:(0,h.__)("Veranstalter ID","evangelische-termine-ausgeben"),value:f,onChange:function(e){return a({id:e})},help:(0,h.__)("Geben Sie die Veranstalter-ID ein.","evangelische-termine-ausgeben")}),(0,r.jsx)(d.RangeControl,{label:(0,h.__)("Anzahl der Veranstaltungen","evangelische-termine-ausgeben"),value:m,onChange:function(e){return a({limit:e})},min:1,max:50}),(0,r.jsx)(d.SelectControl,{label:(0,h.__)("Veranstaltungstyp","evangelische-termine-ausgeben"),value:_,options:F,onChange:function(e){return a({eventType:e})}}),(0,r.jsx)(d.SelectControl,{label:(0,h.__)("Zielgruppe","evangelische-termine-ausgeben"),value:y,options:Z,onChange:function(e){return a({people:e})}}),(0,r.jsx)(d.SelectControl,{label:(0,h.__)("Ortskategorie","evangelische-termine-ausgeben"),value:j,options:G,onChange:function(e){return a({placeType:e})}}),(0,r.jsx)(d.TextControl,{label:(0,h.__)("Nur Veranstaltungen mit folgendem Text","evangelische-termine-ausgeben"),value:S,onChange:function(e){return a({searchText:e})},help:(0,h.__)("Filtert nach Titel oder Beschreibung.","evangelische-termine-ausgeben")})]})}),(0,r.jsxs)("div",Object.assign({},s,{children:[(0,r.jsx)("h2",{children:(0,h.__)("Events","evangelische-termine-ausgeben")}),k&&(0,r.jsx)("p",{children:(0,h.__)("Lade Veranstaltungen...","evangelische-termine-ausgeben")}),I&&(0,r.jsx)("p",{style:{color:"red"},children:I}),(0,r.jsx)("dl",{children:E.map((function(e){var n=function(e){if(e)return e.replace(/\s+\d{1,2}(?:[.:]\d{1,2})?(?:\s*-\s*\d{1,2}(?:[.:]\d{1,2})?)?\s*uhr/gi,"").trim()||e}(e.datum),t=Boolean(e.startTime);return(0,r.jsxs)(p.Fragment,{children:[(0,r.jsx)("dt",{children:e.title&&(0,r.jsx)("strong",{children:e.detailsUrl?(0,r.jsx)("a",{href:e.detailsUrl,target:"_blank",rel:"noopener noreferrer",children:e.title}):e.title})}),n&&(0,r.jsx)("dd",{className:"ln-eta-date",children:(0,r.jsx)("span",{className:"ln-eta-date-text",children:n})}),t&&(0,r.jsx)("dd",{className:"ln-eta-time",children:(0,r.jsx)("span",{className:"ln-eta-time-text",children:e.startTime})}),e.location&&(0,r.jsx)("dd",{className:"ln-eta-location",children:(0,r.jsx)("span",{className:"ln-eta-location-text",children:e.location})})]},e.id)}))})]}))]})},save:function(e){var n=e.attributes,t=c.useBlockProps.save();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",Object.assign({},t,{children:(0,r.jsxs)("h2",{children:["Hello World! ",n.title]})}))})}})}},t={};function r(e){var a=t[e];if(void 0!==a)return a.exports;var i=t[e]={exports:{}};return n[e](i,i.exports,r),i.exports}r.m=n,e=[],r.O=function(n,t,a,i){if(!t){var l=1/0;for(c=0;c<e.length;c++){t=e[c][0],a=e[c][1],i=e[c][2];for(var o=!0,s=0;s<t.length;s++)(!1&i||l>=i)&&Object.keys(r.O).every((function(e){return r.O[e](t[s])}))?t.splice(s--,1):(o=!1,i<l&&(l=i));if(o){e.splice(c--,1);var u=a();void 0!==u&&(n=u)}}return n}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[t,a,i]},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,{a:n}),n},r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e={312:0,40:0};r.O.j=function(n){return 0===e[n]};var n=function(n,t){var a,i,l=t[0],o=t[1],s=t[2],u=0;if(l.some((function(n){return 0!==e[n]}))){for(a in o)r.o(o,a)&&(r.m[a]=o[a]);if(s)var c=s(r)}for(n&&n(t);u<l.length;u++)i=l[u],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(c)},t=self.webpackChunkevangelische_termine_ausgeben=self.webpackChunkevangelische_termine_ausgeben||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))}();var a=r.O(void 0,[40],(function(){return r(284)}));a=r.O(a)}();