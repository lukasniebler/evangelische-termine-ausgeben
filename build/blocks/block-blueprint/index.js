!function(){"use strict";var e={n:function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,{a:t}),t},d:function(n,t){for(var r in t)e.o(t,r)&&!e.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},o:function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}},n=window.ReactJSXRuntime,t=window.wp.blocks;function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function a(e,n){if(e){if("string"==typeof e)return r(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(e,n):void 0}}function i(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,i,l,o=[],s=!0,u=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=i.call(t)).done)&&(o.push(r.value),o.length!==n);s=!0);}catch(e){u=!0,a=e}finally{try{if(!s&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw a}}return o}}(e,n)||a(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var l=window.regeneratorRuntime,o=e.n(l),s=window.wp.blockEditor,u=window.wp.components,c=window.wp.element,d=window.wp.apiFetch,p=e.n(d),h=window.wp.i18n,v=JSON.parse('{"UU":"evangelische-termine-ausgeben/evangelische-termine"}');(0,t.registerBlockType)(v.UU,{icon:{src:(0,n.jsxs)("svg",{id:"Ebene_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[(0,n.jsx)("rect",{x:"60.05",y:"115.69",width:"112.94",height:"280.62",rx:"5.73",ry:"5.73",fill:"evenodd",strokeWidth:"0"}),(0,n.jsx)("rect",{x:"199.53",y:"115.69",width:"112.94",height:"280.62",rx:"5.73",ry:"5.73",fill:"evenodd",strokeWidth:"0"}),(0,n.jsx)("rect",{x:"339.01",y:"115.69",width:"112.94",height:"280.62",rx:"5.73",ry:"5.73",fill:"evenodd",strokeWidth:"0"})]})},__experimentalLabel:function(e,n){var t=n.context,r=e.title;if("list-view"===t&&r)return r},edit:function(e){var t=this,l=e.attributes,d=e.setAttributes,v=(0,s.useBlockProps)(),f=l.id,g=l.limit,m=l.eventType,b=void 0===m?"":m,y=l.people,x=void 0===y?"":y,w=l.placeType,j=void 0===w?"":w,_=i((0,c.useState)([]),2),S=_[0],T=_[1],A=i((0,c.useState)(null),2),C=A[0],E=A[1],V=i((0,c.useState)(!1),2),I=V[0],R=V[1],k=(0,h.__)("Alle Veranstaltungstypen","evangelische-termine-ausgeben"),O=(0,h.__)("Alle Zielgruppen","evangelische-termine-ausgeben"),P=(0,h.__)("Alle Orte","evangelische-termine-ausgeben"),U=i((0,c.useState)([{label:k,value:""}]),2),F=U[0],B=U[1],D=i((0,c.useState)([{label:O,value:""}]),2),L=D[0],W=D[1],Z=i((0,c.useState)([{label:P,value:""}]),2),H=Z[0],M=Z[1];return(0,c.useEffect)((function(){var e,n,i,l,s=!0,u=[{endpoint:"eventtypes",setter:B,label:k},{endpoint:"people",setter:W,label:O},{endpoint:"placetype",setter:M,label:P}];return e=t,n=void 0,i=void 0,l=o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled(u.map((function(e){return n=e.endpoint,p()({path:"evangelische-termine-ausgeben/v1/data?endpoint=".concat(n)});var n})));case 2:if(n=e.sent,s){e.next=5;break}return e.abrupt("return");case 5:n.forEach((function(e,n){if("fulfilled"===e.status){var t=u[n];t.setter((l=e.value,[{label:t.label,value:""}].concat(function(e){if(Array.isArray(e))return r(e)}(i=l.map((function(e){return{label:e.name,value:String(e.id)}})))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||a(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())))}else console.error("Error fetching ".concat(u[n].endpoint,":"),e.reason);var i,l}));case 6:case"end":return e.stop()}}),e)})),new(i||(i=Promise))((function(t,r){function a(e){try{s(l.next(e))}catch(e){r(e)}}function o(e){try{s(l.throw(e))}catch(e){r(e)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,o)}s((l=l.apply(e,n||[])).next())})),function(){s=!1}}),[k,O,P]),(0,c.useEffect)((function(){if(f){R(!0);var e=new URLSearchParams;e.append("vid",f),g&&e.append("itemsPerPage",String(g)),b&&e.append("eventtype",b),x&&e.append("people",x),j&&e.append("placetype",j);var n=e.toString();p()({path:"evangelische-termine-ausgeben/v1/data?endpoint=events&".concat(n)}).then((function(e){console.log(e);var n=e.map((function(e){return{id:e.Veranstaltung.ID,title:e.Veranstaltung._event_TITLE,datum:e.Veranstaltung.DATUM,startRFC:e.Veranstaltung.START_RFC,startTime:e.Veranstaltung.START_UHRZEIT?e.Veranstaltung.START_UHRZEIT.replace(".",":"):void 0}}));T(n),E(null),R(!1)})).catch((function(e){console.error("Error fetching events:",e),E((0,h.__)("Fehler beim Abrufen der Veranstaltungen.","evangelische-termine-ausgeben")),R(!1)}))}}),[f,g,b,x,j]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.InspectorControls,{children:(0,n.jsxs)(u.PanelBody,{title:(0,h.__)("Einstellungen","evangelische-termine-ausgeben"),children:[(0,n.jsx)(u.TextControl,{label:(0,h.__)("Veranstalter ID","evangelische-termine-ausgeben"),value:f,onChange:function(e){return d({id:e})},help:(0,h.__)("Geben Sie die Veranstalter-ID ein.","evangelische-termine-ausgeben")}),(0,n.jsx)(u.RangeControl,{label:(0,h.__)("Anzahl der Veranstaltungen","evangelische-termine-ausgeben"),value:g,onChange:function(e){return d({limit:e})},min:1,max:50}),(0,n.jsx)(u.SelectControl,{label:(0,h.__)("Veranstaltungstyp","evangelische-termine-ausgeben"),value:b,options:F,onChange:function(e){return d({eventType:e})}}),(0,n.jsx)(u.SelectControl,{label:(0,h.__)("Zielgruppe","evangelische-termine-ausgeben"),value:x,options:L,onChange:function(e){return d({people:e})}}),(0,n.jsx)(u.SelectControl,{label:(0,h.__)("Ortskategorie","evangelische-termine-ausgeben"),value:j,options:H,onChange:function(e){return d({placeType:e})}})]})}),(0,n.jsxs)("div",Object.assign({},v,{children:[(0,n.jsx)("h2",{children:(0,h.__)("Events","evangelische-termine-ausgeben")}),I&&(0,n.jsx)("p",{children:(0,h.__)("Lade Veranstaltungen...","evangelische-termine-ausgeben")}),C&&(0,n.jsx)("p",{style:{color:"red"},children:C}),(0,n.jsx)("dl",{children:S.map((function(e){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("dt",{children:(0,n.jsx)("strong",{children:e.title})},e.id),(0,n.jsxs)("dd",{children:[e.datum&&(0,n.jsx)("br",{}),e.datum&&(0,n.jsx)("span",{children:e.datum})]}),(0,n.jsx)("dd",{children:e.startTime&&(0,n.jsx)("span",{children:e.startTime})},"".concat(e.id,"-dd"))]})}))})]}))]})},save:function(e){var t=e.attributes,r=s.useBlockProps.save();return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",Object.assign({},r,{children:(0,n.jsxs)("h2",{children:["Hello World! ",t.title]})}))})}})}();